
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Unitia Voice</title>
    <link rel="manifest" href="data:application/manifest+json,{'name':'Unitia','short_name':'Unitia','display':'standalone','start_url':'.','background_color':'#ffffff','theme_color':'#007bff'}">
    <style>
        body { font-family: sans-serif; display: flex; flex-direction: column; height: 100vh; margin: 0; background: #f4f7f6; }
        header { background: #007bff; color: white; padding: 15px; text-align: center; font-weight: bold; font-size: 1.2rem; }
        #status { padding: 10px; text-align: center; color: #666; font-size: 0.9rem; }
        #result-container { flex: 1; padding: 20px; overflow-y: auto; background: white; margin: 10px; border-radius: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        #result { font-size: 1.1rem; line-height: 1.6; white-space: pre-wrap; }
        #btn-container { padding: 20px; text-align: center; }
        #mic-btn { width: 80px; height: 80px; border-radius: 50%; border: none; background: #007bff; color: white; font-size: 2rem; box-shadow: 0 4px 15px rgba(0,123,255,0.4); cursor: pointer; -webkit-tap-highlight-color: transparent; }
        #mic-btn.active { background: #dc3545; animation: pulse 1.5s infinite; }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }
    </style>
</head>
<body>

<header>UNITIA - ÁèæÂ†¥„É°„É¢</header>
<div id="status">„Éú„Çø„É≥„ÇíÊäº„Åó„Å¶Ë©±„Åó„Å¶„Åè„Å†„Åï„ÅÑ</div>

<div id="result-container">
    <div id="result"></div>
</div>

<div id="btn-container">
    <button id="mic-btn">üé§</button>
</div>

<script>
    const micBtn = document.getElementById('mic-btn');
    const resultDiv = document.getElementById('result');
    const statusDiv = document.getElementById('status');

    // Èü≥Â£∞Ë™çË≠òAPI„ÅÆ„Çª„ÉÉ„Éà„Ç¢„ÉÉ„Éó
    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
    
    if (!SpeechRecognition) {
        statusDiv.innerText = "„Åä‰Ωø„ÅÑ„ÅÆ„Éñ„É©„Ç¶„Ç∂„ÅØÈü≥Â£∞Ë™çË≠òÈùûÂØæÂøú„Åß„Åô";
    } else {
        const recognition = new SpeechRecognition();
        recognition.lang = 'ja-JP';
        recognition.interimResults = true; // ÈÄî‰∏≠ÁµåÈÅé„ÇíË°®Á§∫
        recognition.continuous = true;    // ÈÄ£Á∂öË™çË≠ò

        let isListening = false;

        micBtn.onclick = () => {
            if (!isListening) {
                recognition.start();
            } else {
                recognition.stop();
            }
        };

        recognition.onstart = () => {
            isListening = true;
            micBtn.classList.add('active');
            statusDiv.innerText = "ËÅû„ÅçÂèñ„Çä‰∏≠...";
        };

        recognition.onend = () => {
            isListening = false;
            micBtn.classList.remove('active');
            statusDiv.innerText = "ÂÅúÊ≠¢‰∏≠Ôºà„Çø„ÉÉ„Éó„Åó„Å¶ÂÜçÈñãÔºâ";
        };

        recognition.onresult = (event) => {
            let finalTranscript = '';
            for (let i = event.resultIndex; i < event.results.length; i++) {
                let transcript = event.results[i][0].transcript;
                if (event.results[i].isFinal) {
                    finalTranscript += transcript + '\n';
                }
            }
            if (finalTranscript) {
                resultDiv.innerText += finalTranscript;
                // Ëá™Âãï„Åß‰∏ÄÁï™‰∏ã„Åæ„Åß„Çπ„ÇØ„É≠„Éº„É´
                document.getElementById('result-container').scrollTop = document.getElementById('result-container').scrollHeight;
            }
        };
    }
</script>

</body>
</html>
